# СИСТЕМА УПРАВЛІННЯ ВИРОБНИЦТВОМ
## Технічне завдання

---

## 1. ЗАГАЛЬНІ ВІДОМОСТІ

### 1.1 Призначення системи
Комплексна система автоматизації управління виробничим підприємством, що охоплює весь цикл від запиту клієнта до відвантаження готової продукції.

### 1.2 Основні цілі
- Автоматизація розрахунку калькуляцій та формування КП
- Централізоване зберігання довідникової інформації
- Автоматичне формування виробничої документації
- Контроль матеріальних потоків та запасів
- Відстеження виконання замовлень
- Аналітика та звітність

### 1.3 Ключові принципи
- **Точні розрахунки** — система видає точні дані на основі нормативів
- **Керуючі коефіцієнти** — керівництво регулює кінцеві значення коефіцієнтами
- **Максимальна автоматизація** — документи формуються в один клік
- **Відстеження змін** — повна історія змін з аудитом
- **Доступність** — робота з будь-якого пристрою через браузер

---

## 2. АРХІТЕКТУРА СИСТЕМИ

### 2.1 Технологічний стек
| Компонент | Технологія | Призначення |
|-----------|------------|-------------|
| Frontend | Next.js 14 + React | Користувацький інтерфейс |
| UI | Tailwind CSS + shadcn/ui | Дизайн та компоненти |
| Backend | Next.js API Routes | Серверна логіка |
| ORM | Prisma | Робота з базою даних |
| База даних | PostgreSQL | Зберігання даних |
| Авторизація | NextAuth.js | Управління користувачами |
| Хостинг | Vercel | Розміщення додатку |
| БД хостинг | Supabase / Neon | Хостинг PostgreSQL |
| Файли | Uploadthing / Cloudflare R2 | Зберігання файлів |

### 2.2 Структура модулів

```
┌─────────────────────────────────────────────────────────────────┐
│                         СИСТЕМА                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐   │
│  │ Довід-  │ │   CRM   │ │   КД    │ │   ТПВ   │ │ Закупів │   │
│  │  ники   │ │         │ │         │ │         │ │   лі    │   │
│  └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘   │
│       │          │          │          │          │            │
│       └──────────┴──────────┴──────────┴──────────┘            │
│                            │                                    │
│  ┌─────────┐ ┌─────────┐ ┌┴────────┐ ┌─────────┐ ┌─────────┐   │
│  │  Склад  │ │ Виробн. │ │ Якість  │ │ Фінанси │ │ Аналіт. │   │
│  │         │ │         │ │         │ │         │ │         │   │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. ФУНКЦІОНАЛЬНІ БЛОКИ

### 3.1 ДОВІДНИКИ (пріоритет: КРИТИЧНИЙ)

#### 3.1.1 Базові довідники
- **Одиниці виміру** — шт, кг, м, м², м³, л, год
- **Валюти** — UAH, EUR, USD + автооновлення курсів НБУ
- **Країни** — для експорту/імпорту
- **Ставки ПДВ** — 20%, 7%, 0%, без ПДВ

#### 3.1.2 Матеріали
- **Групи матеріалів** — листовий, сортовий, профільний прокат
- **Марки матеріалів** — Ст3кп, 09Г2С, 12Х18Н10Т + густина
- **Сортамент** — конкретні позиції з розмірами та цінами

#### 3.1.3 Організаційна структура
- **Дільниці** — заготівельна, механічна, зварювальна, складальна
- **Обладнання** — верстати з параметрами та тарифами
- **Склади** — матеріалів, покупних, готової продукції

#### 3.1.4 Контрагенти
- **Клієнти** — реквізити, ПДВ, умови оплати, історія
- **Постачальники** — реквізити, прайс-листи
- **Підрядники** — кооперація (термообробка, покриття)

#### 3.1.5 Технологія
- **Операції** — різання, токарна, фрезерна, зварювання
- **Норми часу** — Тпз, Тшт для операція+обладнання+параметри
- **Розхідні матеріали** — електроди, газ, СОЖ, фарба

#### 3.1.6 Коефіцієнти (редагуються керівництвом)
- **Партійності** — зменшення Тшт при збільшенні партії
- **Складності** — для нестандартних виробів
- **Терміновості** — надбавка за терміновість
- **Накладних витрат** — загальновиробничі, адміністративні

---

### 3.2 CRM / ПРОДАЖІ (пріоритет: ВИСОКИЙ)

#### 3.2.1 Функції
- Реєстрація запитів від клієнтів
- Формування комерційних пропозицій (КП)
- Укладання договорів
- Виставлення рахунків
- Контроль оплат

#### 3.2.2 Особливості КП
- Варіанти партій (1шт / 10шт / 100шт) в одному документі
- Автоперерахунок при зміні кількості
- Режими: з ПДВ / без ПДВ / експорт
- Валюта: UAH / EUR / USD
- Термін дії КП
- Статуси: чернетка → надіслано → узгоджено / відхилено

#### 3.2.3 Документи
- Комерційна пропозиція (PDF)
- Специфікація до КП (PDF)
- Договір (шаблон Word/PDF)
- Рахунок на оплату (PDF)
- Акт звірки (PDF)

---

### 3.3 КОНСТРУКТОРСЬКА ПІДГОТОВКА (пріоритет: ВИСОКИЙ)

#### 3.3.1 Структура виробу
```
ВИРІБ
├── Вузол 1
│   ├── Деталь 1.1 (виготовлення)
│   ├── Деталь 1.2 (виготовлення)
│   └── Болт М10 (покупний)
├── Вузол 2
│   └── ...
└── Деталь 3 (виготовлення)
```

#### 3.3.2 Типи позицій
- **Деталь (виготовлення)** — виготовляється на підприємстві
- **Покупний виріб** — закуповується готовим
- **Стандартний виріб** — кріплення, підшипники тощо

#### 3.3.3 Картка деталі
- Позначення (децимальний номер)
- Найменування
- Матеріал (вибір з довідника)
- Розміри заготовки (товщина × ширина × довжина)
- Автоматичний розрахунок:
  - Площа
  - Об'єм
  - Вага
  - Вартість матеріалу

#### 3.3.4 Версіонування
- Історія версій КД
- Повідомлення про зміни
- Вплив змін на калькуляцію

#### 3.3.5 Документи
- Специфікація виробу
- Відомість покупних
- Відомість матеріалів

---

### 3.4 ТЕХНОЛОГІЧНА ПІДГОТОВКА (пріоритет: ВИСОКИЙ)

#### 3.4.1 Маршрут виготовлення
Для кожної деталі — послідовність операцій:
```
005 Заготівельна   → Гільйотина НГ-6.3  → Тпз=15хв, Тшт=2хв
010 Слюсарна       → Верстак            → Тпз=5хв,  Тшт=5хв
015 Свердлильна    → 2Н135              → Тпз=10хв, Тшт=8хв
020 Зварювання     → MIG-500            → Тпз=10хв, Тшт=15хв
025 Контроль       → ВТК                → Тпз=0,    Тшт=3хв
```

#### 3.4.2 Норми часу
- **Тпз** — підготовчо-заключний час (на партію)
- **Тшт** — штучний час (на одиницю)
- **Тшт.к** = Тшт + Тпз/N (штучно-калькуляційний)

#### 3.4.3 Розрахунок вартості роботи
```
Вартість = Σ ((Тпз + Тшт × N × Кпарт) / 60 × Тариф)
```
де:
- N — кількість деталей
- Кпарт — коефіцієнт партійності (0.6-1.0)
- Тариф — грн/год для обладнання

#### 3.4.4 Калькуляція собівартості

| Стаття | Формула |
|--------|---------|
| Основні матеріали | Σ(маса × ціна) × N |
| Покупні вироби | Σ(кількість × ціна) × N |
| Зворотні відходи | -Σ(відходи × ціна брухту) |
| ТЗВ (транспортно-заготівельні) | Матеріали × % |
| **Разом матеріали** | |
| Основна зарплата | Σ(час × тариф) |
| Додаткова зарплата | ОЗП × % |
| ЄСВ | ФОП × 22% |
| **Разом зарплата** | |
| Загальновиробничі | ОЗП × % |
| **Виробнича собівартість** | |
| Адміністративні | Вироб.соб. × % |
| Збутові | Вироб.соб. × % |
| **Повна собівартість** | |
| Прибуток | ПС × Кмарж |
| **Ціна без ПДВ** | |
| ПДВ | Ціна × ставка |
| **Ціна з ПДВ** | |

#### 3.4.5 Документи
- Маршрутна карта
- Операційні карти
- Калькуляція собівартості
- Відомість норм часу

---

### 3.5 ЗАКУПІВЛІ / КООПЕРАЦІЯ (пріоритет: НОРМАЛЬНИЙ)

#### 3.5.1 Типи закупівель
- **Матеріали** — прокат, кріплення, розхідники
- **Покупні вироби** — готові комплектуючі
- **Послуги** — кооперація (термообробка, покриття)

#### 3.5.2 Процес закупівлі
1. Формування потреби (з виробничого замовлення)
2. Перевірка залишків на складі
3. Створення заявки на закупівлю
4. Вибір постачальника (порівняння цін)
5. Замовлення постачальнику
6. Отримання та вхідний контроль

#### 3.5.3 Кооперація (давальницька схема)
1. Замовлення підряднику
2. Передача матеріалів/деталей (накладна)
3. Виконання робіт
4. Повернення + Акт виконаних робіт

#### 3.5.4 Облік ПДВ
| Тип | Ціна в калькуляцію | ПК |
|-----|-------------------|-----|
| З ПДВ | без ПДВ | так |
| Без ПДВ | як є | ні |
| Імпорт | +мито+доставка | так |

#### 3.5.5 Документи
- Заявка на закупівлю
- Замовлення постачальнику
- Замовлення на кооперацію
- Накладна на передачу
- Акт виконаних робіт

---

### 3.6 СКЛАД (пріоритет: НОРМАЛЬНИЙ)

#### 3.6.1 Типи складів
- Основний склад матеріалів
- Склад покупних виробів
- Склад готової продукції
- Склад інструменту
- Комора дільниці

#### 3.6.2 Операції
- **Прихід** — від постачальника, з виробництва, повернення
- **Розхід** — у виробництво, на кооперацію, відвантаження
- **Переміщення** — між складами
- **Резервування** — під замовлення

#### 3.6.3 Контроль запасів
- Мінімальний запас (сповіщення)
- Точка замовлення
- Дефіцитна відомість

#### 3.6.4 Документи
- Прибуткова накладна
- Видаткова накладна
- Лімітно-забірна карта
- Оборотна відомість
- Інвентаризаційна відомість

---

### 3.7 ВИРОБНИЦТВО (пріоритет: НИЗЬКИЙ - на етапі 5-6)

#### 3.7.1 Виробниче замовлення
- На підставі договору
- Перевірка готовності (КД, ТП, матеріали, оснастка)
- Запуск у виробництво

#### 3.7.2 Планування
- План-графік виробництва (діаграма Ганта)
- Завантаження обладнання
- Розподіл по дільницях

#### 3.7.3 Диспетчеризація
- Змінно-добові завдання
- Відмітки про виконання
- Облік простоїв

#### 3.7.4 Маршрутний лист
- Супровідний документ деталі
- QR-код для швидкого пошуку
- Відмітки по операціях
- Контроль браку

#### 3.7.5 Документи
- Виробниче замовлення
- Змінне завдання
- Маршрутний лист
- Акт про брак

---

### 3.8 КОНТРОЛЬ ЯКОСТІ (пріоритет: НИЗЬКИЙ)

#### 3.8.1 Види контролю
- Вхідний (матеріали)
- Операційний (в процесі)
- Приймальний (готова продукція)

#### 3.8.2 Документи
- Протокол вхідного контролю
- Протокол вимірювань
- Акт про брак
- Паспорт виробу

---

### 3.9 ВІДВАНТАЖЕННЯ (пріоритет: НОРМАЛЬНИЙ)

#### 3.9.1 Внутрішній ринок
- Видаткова накладна
- ТТН
- Рахунок-фактура
- Податкова накладна

#### 3.9.2 Експорт
- Інвойс (в валюті)
- Пакувальний лист
- CMR
- EUR.1 / CT-1
- Митна декларація

#### 3.9.3 Умови поставки (Incoterms)
- EXW — самовивіз
- FCA — франко-перевізник
- DAP — доставка до місця
- та інші

---

### 3.10 ФІНАНСИ (пріоритет: НОРМАЛЬНИЙ)

#### 3.10.1 Розрахунки
- Рахунки вхідні (від постачальників)
- Рахунки вихідні (клієнтам)
- Оплати
- Акти звірки

#### 3.10.2 Заборгованість
- Дебіторська (нам винні)
- Кредиторська (ми винні)

#### 3.10.3 Звітність
- Звіт по оплатах
- Відомість заборгованості
- План надходжень

---

### 3.11 АНАЛІТИКА (пріоритет: ОПЦІЙНО)

#### 3.11.1 Дашборди
- Ключові показники (KPI)
- Графіки продажів
- Виконання плану
- Завантаження обладнання

#### 3.11.2 Звіти
- ABC-аналіз клієнтів
- Аналіз рентабельності
- Аналіз браку
- Порівняння план/факт

---

### 3.12 АДМІНІСТРУВАННЯ

#### 3.12.1 Користувачі та права
- Ролі (адмін, менеджер, конструктор, технолог, ...)
- Матриця прав доступу
- Блокування користувачів

#### 3.12.2 Аудит
- Журнал дій користувачів
- Історія змін (хто, коли, що змінив)
- Версіонування документів

#### 3.12.3 Налаштування
- Реквізити підприємства
- Шаблони документів
- Параметри системи

---

## 4. ІНТЕРФЕЙС КОРИСТУВАЧА

### 4.1 Загальні принципи
- Сучасний мінімалістичний дизайн
- Адаптивність (desktop, tablet, mobile)
- Бічне меню з категоріями
- Хлібні крихти для навігації
- Швидкий пошук (Ctrl+K)

### 4.2 Компоненти форм
- **Текстові поля** — з валідацією та підказками
- **Випадаючі списки** — з пошуком та фільтрацією
- **Дата/час** — календар з швидким вибором
- **Числові поля** — з форматуванням та одиницями
- **Таблиці** — сортування, фільтрація, пагінація
- **Модальні вікна** — для швидкого редагування

### 4.3 Підказки (tooltips)
- При наведенні на поле — опис
- При наведенні на значення — деталі (ціна, залишок, ...)
- Контекстна допомога

### 4.4 Сповіщення
- Toast-повідомлення (успіх/помилка)
- Badge на меню (нові запити, прострочені)
- Email-сповіщення (опційно)

---

## 5. БЕЗПЕКА

### 5.1 Авторизація
- Логін/пароль з хешуванням
- Сесії з таймаутом
- Захист від брутфорсу

### 5.2 Права доступу
- Розмежування по модулях
- Операції: перегляд/створення/редагування/видалення
- Обмеження по даних (тільки свої клієнти)

### 5.3 Аудит
- Логування всіх змін
- Неможливість повного видалення (soft delete)
- Резервне копіювання

---

## 6. ЕТАПИ ВПРОВАДЖЕННЯ

| Етап | Модулі | Результат |
|------|--------|-----------|
| 1 | Інфраструктура + Довідники | База для роботи |
| 2 | Калькулятор матеріалів | Розрахунок ваги/вартості |
| 3 | Технологія + Калькуляція | Повна калькуляція |
| 4 | CRM + Документи | КП, договори, рахунки |
| 5 | Закупівлі + Склад | Контроль матеріалів |
| 6 | Виробництво + Якість | Повний цикл |

---

## 7. ДОДАТКИ

### Додаток А: Глосарій термінів
- **КД** — конструкторська документація
- **ТПВ** — технологічна підготовка виробництва
- **КП** — комерційна пропозиція
- **Тпз** — підготовчо-заключний час
- **Тшт** — штучний час
- **НЗВ** — незавершене виробництво
- **ВТК** — відділ технічного контролю
- **ЛЗК** — лімітно-забірна карта

### Додаток Б: Формули розрахунків
(див. розділ 3.4)

### Додаток В: Структура бази даних
(див. файл 02_СТРУКТУРА_БАЗИ_ДАНИХ.csv)

### Додаток Г: Перелік документів
(див. файл 03_ПЕРЕЛІК_ДОКУМЕНТІВ.csv)

---

*Документ створено: 2024*
*Версія: 1.0*
