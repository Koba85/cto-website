# ERP-система для виробництва: Фінальний огляд

## Зміст документації

| № | Файл | Опис | Пріоритет |
|---|------|------|-----------|
| 01 | ПЛАН_ВПРОВАДЖЕННЯ.csv | Етапи впровадження системи | ⭐⭐⭐ |
| 02 | СТРУКТУРА_БАЗИ_ДАНИХ.csv | Базова структура (спрощена) | ⭐⭐ |
| 03 | ПЕРЕЛІК_ДОКУМЕНТІВ.csv | Види документів в системі | ⭐⭐ |
| 04 | ОПИС_СИСТЕМИ.md | Загальний опис функціоналу | ⭐⭐⭐ |
| 05 | РЕСУРСИ_ТА_ПОСИЛАННЯ.csv | Корисні ресурси | ⭐ |
| 06 | ПРИКЛАДИ_ДАНИХ_ДОВІДНИКІВ.csv | Базові приклади | ⭐ |
| 07 | АНАЛІЗ_УПУЩЕНЬ.md | Що було упущено спочатку | ⭐⭐ |
| 08 | СХЕМА_ЗАЛЕЖНОСТЕЙ.md | Як таблиці пов'язані | ⭐⭐⭐ |
| 09 | ПОВНА_СТРУКТУРА_БД.csv | Повна БД частина 1 | ⭐⭐⭐ |
| 10 | ПОВНА_СТРУКТУРА_БД_частина2.csv | Повна БД частина 2 | ⭐⭐⭐ |
| 11 | ПРИКЛАДИ_ДАНИХ_ПОВНІ.csv | Приклади для всіх довідників | ⭐⭐⭐ |
| 12 | ПРИКЛАД_СТРУКТУРИ_ВИРОБУ.csv | Кронштейн КР-150 з калькуляцією | ⭐⭐⭐ |
| 13 | ПЕРЕВІРКА_ДЕРЕВ.md | Тестування ієрархій | ⭐⭐ |
| 14 | ФІНАЛЬНИЙ_ОГЛЯД.md | Цей документ | ⭐⭐⭐ |

---

## Що створено

### 1. База даних: 60+ таблиць

**Системні довідники:**
- system_settings (налаштування)
- units (одиниці виміру)
- currencies, exchange_rates (валюти, курси)
- countries (країни)
- vat_rates (ставки ПДВ)

**Організаційна структура:**
- departments (підрозділи) - ДЕРЕВО
- warehouses (склади)
- users, roles (користувачі, ролі)

**Матеріали:**
- material_groups (групи) - ДЕРЕВО
- material_grades (марки сталі)
- materials (матеріали)
- material_dimensions (розміри)
- material_prices, material_prices_history (ціни)
- material_batches (партії для простежуваності)

**Обладнання та операції:**
- equipment (обладнання)
- operations (операції)
- time_norms (нормативи часу)
- consumables (витратні матеріали)
- overhead_rates (накладні витрати)

**Контрагенти:**
- contractors (постачальники, клієнти)
- contacts (контактні особи)
- contractor_prices (ціни постачальників)

**Проекти та вироби:**
- projects (замовлення)
- items (позиції/деталі) - ДЕРЕВО
- item_routes (маршрути)
- item_operations (операції)
- item_materials (матеріали деталі)

**Калькуляції:**
- calculations (розрахунки)
- calculation_details (деталізація)
- batch_coefficients (коефіцієнти партійності)

**Документообіг:**
- document_categories (категорії) - ДЕРЕВО
- documents (документи)
- document_versions (версії)
- document_approvals (погодження)

**Виробництво:**
- production_orders (виробничі замовлення)
- production_tasks (завдання)
- work_time_log (облік часу)

**Якість:**
- quality_checks (перевірки якості)
- defects (дефекти)
- serial_numbers (серійні номери)

**Відвантаження:**
- shipments (відвантаження)
- shipment_items (позиції відвантаження)

**Аудит:**
- audit_log (журнал змін)

---

### 2. Ієрархічні структури (дерева)

Всі дерева побудовані за єдиним принципом:

```
id          - унікальний ідентифікатор
parent_id   - посилання на батька (NULL = корінь)
level       - рівень вкладеності (0 = корінь)
path        - повний шлях: "ID1/ID2/ID3"
sort_order  - порядок сортування
```

**Дерева в системі:**
1. **departments** - підрозділи підприємства
2. **material_groups** - групи матеріалів
3. **items** - структура виробу (специфікація)
4. **document_categories** - категорії документів

---

### 3. Приклади даних

Для кожного довідника створено мінімум 3 приклади:

| Довідник | Кількість прикладів |
|----------|---------------------|
| Одиниці виміру | 10 |
| Валюти | 3 |
| Країни | 4 |
| Ставки ПДВ | 4 |
| Ролі | 7 |
| Підрозділи | 10 |
| Склади | 4 |
| Групи матеріалів | 14 |
| Марки сталі | 6 |
| Матеріали | 13 |
| Обладнання | 10 |
| Операції | 13 |
| Нормативи часу | 9 |
| Витратні матеріали | 8 |
| Накладні витрати | 5 |
| Контрагенти | 8 |

---

### 4. Повний приклад виробу

**Кронштейн КР-150** - повна структура:
- 3 деталі власного виготовлення
- 3 покупні позиції (кріплення)
- Маршрути для кожної деталі
- Калькуляція для партій: 1, 10, 50, 100 шт

---

## Ключові формули

### Собівартість деталі:
```
Собівартість = Матеріали + Робота + Накладні

Матеріали = Вага × Ціна_за_кг × Коеф_відходу
Робота = Σ(Час_операції × Ставка_верстата)
Накладні = (Матеріали + Робота) × %_накладних
```

### Коефіцієнт партійності:
```
Ціна_партії = Ціна_1шт × Коеф_партійності

Приклад:
1 шт  → коеф. 1.0 → 1500 грн
10 шт → коеф. 0.8 → 1200 грн
50 шт → коеф. 0.6 → 900 грн
```

---

## Порядок створення таблиць

При розгортанні БД таблиці створюються в такому порядку (залежності):

**Рівень 0** (без залежностей):
- system_settings, units, currencies, countries, vat_rates, roles

**Рівень 1** (залежать від рівня 0):
- exchange_rates, departments, warehouses, material_groups, material_grades

**Рівень 2:**
- users, materials, equipment, operations, contractor_types, document_categories

**Рівень 3:**
- material_dimensions, material_prices, contractors, consumables

**Рівень 4:**
- contacts, overhead_rates, contractor_prices, projects

**Рівень 5:**
- items, documents, batch_coefficients

**Рівень 6:**
- item_routes, calculations, document_versions

**Рівень 7:**
- item_operations, item_materials, calculation_details, production_orders

**Рівень 8:**
- production_tasks, shipments, quality_checks

**Рівень 9:**
- work_time_log, defects, serial_numbers

**Рівень 10:**
- audit_log (залежить від усього)

---

## Наступні кроки

### Етап 1: Налаштування середовища
- [ ] Встановити Node.js 18+
- [ ] Створити акаунти: GitHub, Vercel, Supabase
- [ ] Клонувати шаблон Next.js

### Етап 2: База даних
- [ ] Створити БД на Supabase
- [ ] Виконати SQL-скрипти для створення таблиць
- [ ] Заповнити базові довідники

### Етап 3: Backend API
- [ ] Налаштувати Prisma ORM
- [ ] Створити API endpoints для довідників
- [ ] Реалізувати CRUD операції

### Етап 4: Frontend
- [ ] Налаштувати shadcn/ui
- [ ] Створити сторінки для довідників
- [ ] Реалізувати форми введення

### Етап 5: Калькуляція
- [ ] Реалізувати розрахунок собівартості
- [ ] Додати коефіцієнти партійності
- [ ] Створити форму калькуляції

### Етап 6: Документообіг
- [ ] Реалізувати генерацію документів
- [ ] Додати версіонування
- [ ] Налаштувати погодження

---

## Гарантії розширюваності

Система спроектована так, щоб:

1. **Можна додавати нові поля** - кожна таблиця має структуру, яка дозволяє додавати нові колонки без зміни існуючих

2. **Можна додавати нові таблиці** - залежності чітко визначені, нові таблиці додаються на відповідний рівень

3. **Можна змінювати ієрархії** - структура parent_id/level/path дозволяє необмежену вкладеність

4. **Історія змін зберігається** - audit_log та *_history таблиці

5. **Ціни версіонуються** - material_prices_history зберігає історію цін

6. **Документи версіонуються** - document_versions для кожного документа

---

## Контакти для питань

Якщо виникнуть питання під час реалізації - продовжуйте діалог у цій сесії або створіть нову з посиланням на цю документацію.

---

*Документацію створено: 2026-02-02*
*Автор: Claude AI Assistant*
